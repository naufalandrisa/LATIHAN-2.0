<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Minhajul Haq</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>
    <div class="container-fluid p-0 d-flex h-100">
        <div id="bdSidebar" class="d-flex flex-column flex-shrink-0 p-3 bg-dark text-white offcanvas-md offcanvas-start" style="width: 280px;">
            <a href="http://localhost:3000" class="navbar-brand">
                <h5><i class="fa-solid fa-building-columns me-2" style="font-size: 28px;"></i> Minjahul Haq</h5>
            </a>
            <hr>
            <ul class="mynav nav nav-pills flex-column mb-auto">
                <li class="nav-item mb-1">
                    <a href="http://localhost:3000/dashboard" class="">
                        <i class="fa-solid fa-palette"></i>
                        Dashboard
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="http://localhost:3000/santri" class="">
                        <i class="fa-solid fa-graduation-cap"></i>
                        Santri
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="http://localhost:3000/guru" class="">
                        <i class="fa-solid fa-person-chalkboard"></i>
                        Guru
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="http://localhost:3000/pasal" class="">
                        <i class="fa-solid fa-people-roof"></i>
                        Pasal
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="http://localhost:3000/pelanggaran" class="active">
                        <i class="fa-solid fa-scale-balanced"></i>
                        Pelanggaran
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="http://localhost:3000/admin" class="">
                        <i class="fa-solid fa-user"></i>
                        Admin
                    </a>
                </li>
                <li class="nav-item mb-1">
                    <a href="/logout" class="">
                        <i class="fa-solid fa-arrow-right-from-bracket"></i>
                        Logout
                    </a>
                </li>
            </ul>
            <hr>
            <div class="d-flex">
                <span>
                    <h6 class="mt-1 mb-0">&copy; Minhajul Haq 2023</h6>
                    <small>Developed By Naufal Andrisa</small>
                </span>
            </div>
        </div>
        <div class="bg-light flex-fill">
            <div class="p-2 d-md-none d-flex text-white bg-dark">
                <a href="#" class="text-white" data-bs-toggle="offcanvas" data-bs-target="#bdSidebar">
                    <i class="fa-solid fa-bars"></i>
                </a>
                <span class="ms-3">Minhajul Haq</span>
            </div>
            <div class="p-4">
                <nav style="--bs-breadcrumb-divider:'>';font-size:14px">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><i class="fa-solid fa-house"></i></li>
                        <li class="breadcrumb-item">Pelanggaran</li>
                        <div class="whois">
                            <h6>Hi, <%= username %></h6>
                        </div>
                    </ol>
                </nav> 
                <hr>
                <div class="row"> 
                    <div class="col">
                        <div class="card border-0 shadow rounded bg-white">
                            <div class="card-body">
                                <form action="store" method="post">
                                    <div class="form-group">
                                        <div class="form-group">
                                            <label>Waktu</label>
                                            <input type="text" class="form-control" name="waktu" value="<%= waktu%>" disabled>
                                        </div>
                                        <label>Nama Santri</label>
                                        <input type="text" class="form-control" name="nama" id="nama" placeholder="Cari nama santri" oninput="getSuggestions(this.value)" >
                                        <input type="text" class="form-control" name="santri_id" id="santri_id" value="" hidden>
                                    
                                        <div id="suggestions-container"></div>
                                    </div>
                                    <div class="form-group">
                                        <label>Kelas</label>
                                        <input type="text" class="form-control" name="kelas" id="kelas" value="" readonly>
                                    </div>
                                    <div class="form-group">
                                        <label>Pasal</label>
                                        <input type="text" class="form-control" name="pasal" id="pasal" value="" placeholder="Cari pasal pelanggaran" oninput="getSuggestionsPasal(this.value)">
                                        <input type="text" class="form-control" name="pasal_id" id="pasal_id" value="" hidden>
                                    
                                        <div id="pasal-container"></div>
                                    </div>
                                    <div class="form-group">
                                        <label>Keterangan</label>
                                        <input type="text" class="form-control" name="keterangan" id="keterangan" value="" readonly>
                                    </div>
                                    <div class="form-group">
                                        <label>Catatan</label>
                                        <input type="text" class="form-control" name="catatan" value="" placeholder="Catatan tambahan">
                                    </div>
                                    <br>
                                    <button type="submit" class="btn btn-primary">UPDATE</button>
                                    <a href="http://localhost:3000/guru" class="btn btn-dark">BACK</a>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>  
        </div>
    </div>
    <script>
        function getSuggestions(input) {
           document.getElementById('suggestions-container').innerHTML = '';
       
           if (input.trim!=="") {
               $.ajax({
                   url: '/pelanggaran/search/nama?suggest=true&nama=' + input,
                   method: 'GET',
                   success: function (data) {
                       console.log('Success:', data);
                       var suggestionsContainer = document.getElementById('suggestions-container');
                       data.forEach(function (item) {
                           var suggestionDiv = document.createElement('div');
                           var hiddenInput = document.createElement('input');
                           suggestionDiv.innerHTML = '<span class="outlined-span">' + item.nama + '</span>';
                            hiddenInput.type = 'hidden';
                            hiddenInput.name = 'santri_id'; 
                           suggestionDiv.onclick = function () {
                               document.getElementById('nama').value = item.nama;
                               document.getElementById('kelas').value = item.kelas;
                               document.getElementById('santri_id').value= item.id; 
                               document.getElementById('suggestions-container').innerHTML = '';
                           };
                           suggestionsContainer.appendChild(suggestionDiv);
                       });
                   },
                   error: function (error) {
                       console.error('Error fetching suggestions:', error);
                   }
               });
           }
       }
       
       function getSuggestionsPasal(input) {
           document.getElementById('pasal-container').innerHTML = '';
       
           if (input.trim!=="") {
               $.ajax({
                   url: '/pelanggaran/search/pasal?suggest=true&nama=' + input,
                   method: 'GET',
                   success: function (data) {
                       console.log('Success:', data);
                       var suggestionsContainer = document.getElementById('pasal-container');
                       data.forEach(function (item) {
                            var suggestionDiv = document.createElement('div');
                           suggestionDiv.innerHTML = '<span class="outlined-span">' + item.nama + '</span>';
                           suggestionDiv.onclick = function () {
                               document.getElementById('pasal').value = item.nama;
                               document.getElementById('keterangan').value = item.keterangan;
                                document.getElementById('pasal_id').value= item.id; 
                               document.getElementById('pasal-container').innerHTML = '';
                           };
                           suggestionsContainer.appendChild(suggestionDiv);
                       });
                   },
                   error: function (error) {
                       console.error('Error fetching suggestions:', error);
                   }
               });
           }
       }
       </script>
</body>
</html>




